let products = {
  data: [
    {
      productName: "Pinball-kub",
      creator: "Thanut and Chanon",
      category: "Motion",
      price: "30",
      image: "../assets/images/products/motion/Pinball-Kub.png",
      link : "index.html",
    },
    {
      productName: "Pinnball-MooDeng",
      creator: "Palise and Phurichaya",
      category: "Motion",
      price: "30",
      image: "../assets/images/products/motion/MooDeng.png",
      link : "haha.html",
    },
    {
      productName: "Pinball-SquidGame",
      creator: "Natapat and Phruek",
      category: "Motion",
      price: "99",
      image: "../assets/images/products/motion/Squid-Game.png",
      link : "index.html",
    },
    {
      productName: "Commercial-Zesto",
      creator: "Palise and Phurichaya",
      category: "Motion",
      price: "29",
      image: "../assets/images/products/motion/Zesto.png",
      link : "index.html",
    },
    {
      productName: "Commercial-TheBoys",
      creator: "Thanut Chanon Natapat and Phruek",
      category: "Motion",
      price: "129",
      image: "../assets/images/products/motion/The-Boys.png",
      link : "index.html",
    },
    {
      productName: "Lyrics-Blindinglights",
      creator: "Thanut Chanon Natapat and Phruek",
      category: "Motion",
      price: "89",
      image: "../assets/images/products/motion/Lyrics-Video.png",
      link : "index.html",
    },
    {
      productName: "Lyrics-Luther",
      creator: "Palise and Phurichaya",
      category: "Motion",
      price: "189",
      image: "../assets/images/products/motion/Love.png",
      link : "index.html",
    },
    {
      productName: "Factory-HarryPoter",
      creator: "Thanut Chanon Natapat and Phruek",
      category: "Motion",
      price: "49",
      image: "../assets/images/products/motion/Factory-Tour.png",
      link : "index.html",
    },
    {
      productName: "Factory-Teletubbies",
      creator: "Palise and Phurichaya",
      category: "Motion",
      price: "49",
      image: "../assets/images/products/motion/Teletubbies.png",
      link : "index.html",
    },
    {
      productName: "Museum",
      creator: "1103production",
      category: "Motion",
      price: "49",
      image: "../assets/images/products/motion/Museum.png",
      link : "index.html",
    },
     {
      productName: "Fossil",
      creator: "1103production",
      category: "Motion",
      price: "49",
      image: "../assets/images/products/motion/Fossil.png",
      link : "index.html",
    },
    {
      productName: "Loop",
      creator: "Natapat",
      category: "Motion",
      price: "49",
      image: "../assets/images/products/motion/Loop.png",
      link : "index.html",
    },
    {
      productName: "Lowlight",
      creator: "All",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Lowlight.jpg",
      link : "index.html",
    },
    {
      productName: "Street",
      creator: "Phruek",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Street_jump.jpg",
      link : "index.html",
    },
    {
      productName: "Food Dining",
      creator: "Palise Phurichaya Natapat and Thanut",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Food-Dining.jpg",
      link : "index.html",
    },
    {
      productName: "Different",
      creator: "Phruek and Chanon",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Different.jpg",
      link : "index.html",
    },
    {
      productName: "Stock photo",
      creator: "Phruek",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Stock_jump.HEIC",
      link : "index.html",
    },
    {
      productName: "City",
      creator: "Phurichaya",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/City.jpg",
      link : "index.html",
    },
    {
      productName: "Leaf",
      creator: "Phruek and Chanon",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Leaf_jumpchanon.jpg",
      link : "index.html",
    },
    {
      productName: "Goose",
      creator: "Phurichaya",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Duck_hut.HEIC",
      link : "index.html",
    },
    {
      productName: "BTS",
      creator: "Chanon",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/BTS_chanon.jpg",
      link : "index.html",
    },
    {
      productName: "Barn",
      creator: "Thanut",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Barn_TK.jpg",
      link : "index.html",
    },
    {
      productName: "Military",
      creator: "Phruek",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Military.jpg",
      link : "index.html",
    },
    {
      productName: "Building",
      creator: "Kadsan",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Building_Gram.Heic",
      link : "index.html",
    },
    {
      productName: "Cave",
      creator: "Phurichaya",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Cave_hut.jpg",
      link : "index.html",
    },
    {
      productName: "Hua-Lum-Phong",
      creator: "Kadsan",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/HuaLumPhong_Gram.Heic",
      link : "index.html",
    },
    {
      productName: "Meow",
      creator: "Phurichaya",
      category: "Production",
      price: "49",
      image: "../assets/images/products/production/Meow_hut.jpg",
      link : "index.html",
    },
    
    {
      productName: "",
      creator: "Natapat",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Photomanipulate_TK.png",
      link : "index.html",
    },
    {
      productName: "Fujii",
      creator: "Phruek",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Fujii_jump.png",
      link : "index.html",
    },
     {
      productName: "Wallpaper",
      creator: "Natapat",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Wallpaper_Nat2.png",
      link : "index.html",
    },
    {
      productName: "Poster-Korat",
      creator: "Phruek",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Korat4_jump.jpg",
      link : "index.html",
    },
    {
      productName: "Poster-Kanom",
      creator: "Natapat",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Commerc_Nat.png",
      link : "index.html",
    },
    {
      productName: "Shirt",
      creator: "Natapat",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Natshirt.png",
      link : "index.html",
    },
    {
      productName: "Poster-Eminem",
      creator: "Phruek",
      category: "GraphicDesign",
      price: "49",
      image: "../assets/images/products/graphic/Eminem_jump.png",
      link : "index.html",
    },
     {
      productName: "Mahito",
      creator: "Phreuk",
      category: "Artwork",
      price: "49",
      image: "../assets/images/products/artwork/Mahito_jump.png",
      link : "index.html",
    },
    {
      productName: "Pixel-Pigachu",
      creator: "Phruek",
      category: "Artwork",
      price: "49",
      image: "../assets/images/products/artwork/Pixel_jump.png",
      link : "index.html",
    },
    {
      productName: "Pixel-TK",
      creator: "Thanut",
      category: "Artwork",
      price: "49",
      image: "../assets/images/products/artwork/TK-Pixel.png",
      link : "index.html",
    },
    {
      productName: "Pixel-Shrek",
      creator: "Phurikchaya",
      category: "Artwork",
      price: "49",
      image: "../assets/images/products/artwork/sherkhut.png",
      link : "index.html",
    },
    
  ],
};

let animationDelay = 0;
for (let i of products.data) {
  //Create link wrapper
  let link = document.createElement("a");
  link.href = i.link || `product-detail.html?id=${i.productName.toLowerCase().replace(/\s+/g, '-')}`;
  link.classList.add("card-link");
  // Set the animation delay for the staggered effect
  link.style.animationDelay = `${animationDelay}ms`;
  animationDelay += 150; 
  
  //Create Card
  let card = document.createElement("div");
  //Card should have category and should stay hidden initially
  card.classList.add("card", i.category);
  //image div
  let imgContainer = document.createElement("div");
  imgContainer.classList.add("image-container");
  //img tag
  let image = document.createElement("img");
  image.setAttribute("src", i.image);
  imgContainer.appendChild(image);
  card.appendChild(imgContainer);
  //container
  let container = document.createElement("div");
  container.classList.add("container");
  //creator name
  let creator = document.createElement("p");
  creator.classList.add("creator-name");
  creator.innerText = i.creator || "Unknown Creator";
  container.appendChild(creator);
  //product name
  let name = document.createElement("h5");
  name.classList.add("product-name");
  name.innerText = i.productName.toUpperCase();
  container.appendChild(name);
  //price
  let price = document.createElement("h6");
  price.innerText = "$" + i.price;
  container.appendChild(price);

  card.appendChild(container);
  link.appendChild(card);
  document.getElementById("products").appendChild(link);
}

//parameter passed from button (Parameter same as category)
function filterProduct(value) {
  // Clear search input when a category is clicked
  document.getElementById("search-input").value = "";

  //Button class code
  let buttons = document.querySelectorAll(".button-value");
  buttons.forEach((button) => {
    //check if value equals innerText
    if (value.toUpperCase() == button.innerText.toUpperCase()) {
      button.classList.add("active");
    } else {
      button.classList.remove("active");
    }
  });

  //select all cards and their parent links
  let elements = document.querySelectorAll(".card");
  let links = document.querySelectorAll(".card-link");
  //loop through all cards
  elements.forEach((element, index) => {
    const link = links[index];
    //display all cards on 'all' button click
    if (value == "all") {
      link.classList.remove("hide");
    } else {
      //Check if element contains category class
      if (element.classList.contains(value)) {
        //display element based on category
        link.classList.remove("hide");
      } else {
        //hide other elements
        link.classList.add("hide");
      }
    }
  });
}

//Search function
function searchProducts() {
  //initializations
  let searchInput = document.getElementById("search-input").value.trim().toUpperCase();
  let elements = document.querySelectorAll(".product-name");
  let cards = document.querySelectorAll(".card");
  let links = document.querySelectorAll(".card-link");

  //loop through all elements
  elements.forEach((element, index) => {
    //check if text includes the search value (case-insensitive)
    const link = links[index];
    const isSearchMatch = element.innerText.toUpperCase().includes(searchInput);

    if (isSearchMatch) {
      //display matching card
      link.classList.remove("hide");
    } else {
      //hide others
      link.classList.add("hide");
    }
  });
}

// Reset category to "All" when user starts searching
document.getElementById("search-input").addEventListener("input", () => {
  // When user types in search, deactivate category buttons
  let buttons = document.querySelectorAll(".button-value");
  buttons.forEach((button) => {
    if (!button.innerText.includes("All")) {
      button.classList.remove("active");
    } else {
      button.classList.add("active");
    }
  });
  searchProducts();
});


//Search button click
document.querySelector("button#search").addEventListener("click", searchProducts);

//Initially display all products
window.onload = () => {
  filterProduct("all");
};